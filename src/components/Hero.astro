---
import AnimatedHeading from "./AnimatedHeading.astro";
---
<section class="md:pt-48 md:pb-32 mesh-gradient border-white/5 border-b pt-32 pr-6 pb-20 pl-6 relative">
  <div class="text-center max-w-5xl mx-auto">
    <div class="availability-wrap mb-8">
      <div class="availability-pill" role="status" aria-live="polite">
        <span class="availability-dot" aria-hidden="true"></span>
        <span class="availability-text">Available for Q1 Consulting</span>
      </div>
    </div>
    <AnimatedHeading
      class="md:text-6xl lg:text-7xl leading-[1] md:leading-[0.95] lg:leading-[0.85] text-4xl font-semibold text-white tracking-tight mb-0 max-w-4xl mx-auto"
      text="We can help manage the tech that runs your business."
    />
    <p class="text-base md:text-lg text-zinc-400 max-w-2xl mx-auto leading-relaxed font-light mb-10 mt-4 md:mt-6 lg:mt-0 lg:-mt-4">
      GLF Analytics drives strategy, execution, and data infrastructure for ambitious brands. From custom Shopify builds to enterprise-grade data warehousing.
    </p>
    <div class="flex flex-col sm:flex-row items-center justify-center gap-4">
      <a
        href="mailto:contact@glfanalytics.com"
        class="w-full sm:w-auto px-6 py-3 bg-white text-black text-sm font-medium rounded-md hover:bg-zinc-200 transition-all flex items-center justify-center gap-2 group"
      >
        Start a Project
        <svg
          xmlns="http://www.w3.org/2000/svg"
          aria-hidden="true"
          role="img"
          width="16"
          height="16"
          viewBox="0 0 24 24"
        >
          <path
            fill="none"
            stroke="currentColor"
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M5 12h14m-7-7l7 7l-7 7"
          ></path>
        </svg>
      </a>
      <a
        href="#timeline"
        class="w-full sm:w-auto px-6 py-3 border border-zinc-800 text-zinc-300 text-sm font-medium rounded-md hover:bg-white/5 transition-colors flex items-center justify-center gap-2"
      >
        View Case Studies
      </a>
    </div>
  </div>
</section>

<style is:global>
  .availability-wrap {
    --pill-pad: 14px;
    --dot-size: 10px;
    --dot-gap: 14px;
    --content-shift: 2px;
    --text-nudge: -6px;
    --dot-shift: 0px;
    height: 36px;
    display: inline-block;
  }

  .availability-pill {
    height: 36px;
    width: max-content;
    display: inline-flex;
    align-items: center;
    padding: 0 var(--pill-pad);
    padding-left: calc(var(--pill-pad) + var(--dot-size) + var(--dot-gap));
    border-radius: 9999px;
    background: rgba(255, 255, 255, 0.06);
    border: 1px solid rgba(255, 255, 255, 0.15);
    color: #e5e7eb;
    overflow: hidden;
    clip-path: inset(0 calc(50% - 18px) 0 calc(50% - 18px) round 9999px);
    transition: clip-path 900ms cubic-bezier(0.22, 1, 0.36, 1) 800ms;
    backdrop-filter: blur(6px);
    position: relative;
  }

  .availability-dot {
    width: var(--dot-size);
    height: var(--dot-size);
    border-radius: 9999px;
    background: #22c55e;
    box-shadow: 0 0 8px rgba(34, 197, 94, 0.35);
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    transition: transform 900ms cubic-bezier(0.22, 1, 0.36, 1) 800ms;
  }

  .availability-text {
    white-space: nowrap;
    font-size: 12px;
    letter-spacing: 0.01em;
    opacity: 0;
    transform: translateY(1px) translateX(var(--text-nudge));
    transition: opacity 360ms ease-out 1000ms, transform 360ms ease-out 1000ms;
  }

  .availability-wrap.is-animate .availability-pill {
    clip-path: inset(0 0 0 0 round 9999px);
  }

  .availability-wrap.is-animate .availability-dot {
    transform: translate(
      calc(-50% - var(--dot-shift) + var(--content-shift)),
      -50%
    );
  }

  .availability-wrap.is-animate .availability-text {
    opacity: 1;
    transform: translateY(0)
      translateX(calc(var(--text-nudge) + var(--content-shift)));
  }

  @media (prefers-reduced-motion: reduce) {
    .availability-pill {
      transition: none;
      clip-path: inset(0 0 0 0 round 9999px);
    }

    .availability-dot {
      transition: none;
      transform: translate(
        calc(-50% - var(--dot-shift) + var(--content-shift)),
        -50%
      );
    }

    .availability-text {
      transition: none;
      opacity: 1;
      transform: translateX(calc(var(--text-nudge) + var(--content-shift)));
    }
  }
</style>

<script is:inline>
  const availabilityWraps = document.querySelectorAll(".availability-wrap");
  const animateAvailability = () => {
    availabilityWraps.forEach((wrap) => {
      const pill = wrap.querySelector(".availability-pill");
      if (pill) {
        const styles = getComputedStyle(wrap);
        const pillPad = parseFloat(styles.getPropertyValue("--pill-pad")) || 0;
        const dotSize = parseFloat(styles.getPropertyValue("--dot-size")) || 0;
        const dotShift = (pill.offsetWidth / 2) - pillPad - (dotSize / 2);
        wrap.style.setProperty("--dot-shift", `${dotShift}px`);
      }
      wrap.classList.add("is-animate");
    });
  };

  if (document.readyState === "loading") {
    document.addEventListener("DOMContentLoaded", animateAvailability);
  } else {
    animateAvailability();
  }
</script>
